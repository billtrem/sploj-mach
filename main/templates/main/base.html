{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>{% block title %}Sploj{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'main/style.css' %}">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <nav>
        <div class="nav-wrapper">
            <a href="{% url 'whats_on' %}" class="logo">
                <img src="{% static 'main/images/logo.png' %}" alt="Sploj Logo" class="logo-img">
            </a>
            <button class="hamburger" onclick="toggleMenu()">☰</button>
            <div class="nav-links" id="navLinks">
                <span class="nav-close" onclick="toggleMenu()">×</span>
                <a href="{% url 'whats_on' %}">What’s On</a>
                <a href="{% url 'info' %}">Info</a>
            </div>
        </div>
    </nav>

    <div class="content">
        {% block content %}{% endblock %}
    </div>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-inner" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 40px; align-items: center; text-align: center;">

                <!-- Social Media Icons -->
                <div class="footer-socials" style="display: flex; justify-content: center; gap: 20px;">
                    <a href="https://www.instagram.com/splojmach/" target="_blank" aria-label="Instagram">
                        <img src="{% static 'main/images/instagram.png' %}" alt="Instagram">
                    </a>
                    <a href="https://www.youtube.com/channel/UCEtqhvb3QRLa2NFPVxM7XGg" target="_blank" aria-label="YouTube">
                        <img src="{% static 'main/images/youtube.png' %}" alt="YouTube">
                    </a>
                    <a href="https://chat.whatsapp.com/CwqzmAqxddE1d0Qu548dfm" target="_blank" aria-label="WhatsApp">
                        <img src="{% static 'main/images/whatsapp.png' %}" alt="WhatsApp">
                    </a>
                </div>

                <!-- Newsletter Signup -->
                <div id="mc_embed_signup" class="newsletter-section" style="margin: 0;">
                    <form id="newsletter-form">
                        <h2>Subscribe to the Sploj Newsletter</h2>
                        <div class="mc-field-group" id="newsletter-fields" style="display: flex; gap: 10px; align-items: center;">
                            <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                            <input type="email" name="EMAIL" id="mce-EMAIL" required>
                            <input type="submit" class="button" value="Subscribe">
                        </div>
                        <div id="newsletter-message" style="display:none; font-weight:bold; color:green;">
                            ✅ Thanks for subscribing!
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </footer>

        <script>
        function toggleMenu() {
            document.getElementById("navLinks").classList.toggle("active");
        }

        document.getElementById('newsletter-form').addEventListener('submit', function(e) {
            e.preventDefault();
            let email = document.getElementById('mce-EMAIL').value.trim();
            if (!email) return;

            // JSONP callback name
            let callbackName = 'mcCallback_' + Math.random().toString(36).substring(2);
            window[callbackName] = function(resp) {
                if (resp.result === 'success') {
                    document.getElementById('newsletter-fields').style.display = 'none';
                    document.getElementById('newsletter-message').style.display = 'block';
                } else {
                    alert("There was an issue: " + resp.msg);
                }
                delete window[callbackName];
            };

            // Create script tag for Mailchimp JSONP
            let script = document.createElement('script');
            script.src = `https://gmail.us19.list-manage.com/subscribe/post-json?u=7e366cd9853fa4d214985e801&id=71e46e4b02&EMAIL=${encodeURIComponent(email)}&c=${callbackName}`;
            document.body.appendChild(script);
        });
    </script>

    {% block extra_js %}{% endblock %}

</body>
</html>
