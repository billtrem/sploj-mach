{% extends 'main/base.html' %}
{% load static %}

{% block title %}Info / Gwybodaeth â€“ Sploj{% endblock %}

{% block content %}
{% if sections %}
<div class="info-sections">
    {% for section in sections %}
        <div class="info-section">

            {# Carousel if section has extra images #}
            {% if section.get_carousel_images %}
                <div class="carousel" id="carousel-{{ forloop.counter }}">
                    <div class="carousel-track">
                        {% for image in section.get_carousel_images %}
                            <div class="carousel-slide">
                                <img src="{{ image.url }}" alt="{{ section.title }}">
                            </div>
                        {% endfor %}
                    </div>
                    <button class="carousel-btn prev" data-carousel="{{ forloop.counter }}">&#10094;</button>
                    <button class="carousel-btn next" data-carousel="{{ forloop.counter }}">&#10095;</button>
                </div>
            {% elif section.image %}
                <img src="{{ section.image.url }}" alt="{{ section.title }}" style="max-width:100%; height:auto;">
            {% endif %}

            <h2>{{ section.title }}</h2>
            <p>{{ section.content|linebreaks }}</p>

            {% if section.is_links_section %}
                <ul>
                    {% if section.link_1_label and section.link_1_url %}
                        <li><a href="{{ section.link_1_url }}" target="_blank">{{ section.link_1_label }}</a></li>
                    {% endif %}
                    {% if section.link_2_label and section.link_2_url %}
                        <li><a href="{{ section.link_2_url }}" target="_blank">{{ section.link_2_label }}</a></li>
                    {% endif %}
                    {% if section.link_3_label and section.link_3_url %}
                        <li><a href="{{ section.link_3_url }}" target="_blank">{{ section.link_3_label }}</a></li>
                    {% endif %}
                    {% if section.link_4_label and section.link_4_url %}
                        <li><a href="{{ section.link_4_url }}" target="_blank">{{ section.link_4_label }}</a></li>
                    {% endif %}
                </ul>
            {% endif %}

            {% if section.funder_logo_1 or section.funder_logo_2 or section.funder_logo_3 or section.funder_logo_4 %}
            <div class="partner-logos" style="text-align: center; margin: 2rem 0;">
                {% if section.funder_logo_1 %}
                    <img src="{{ section.funder_logo_1.url }}" alt="" style="height: 60px; margin: 0 15px;">
                {% endif %}
                {% if section.funder_logo_2 %}
                    <img src="{{ section.funder_logo_2.url }}" alt="" style="height: 60px; margin: 0 15px;">
                {% endif %}
                {% if section.funder_logo_3 %}
                    <img src="{{ section.funder_logo_3.url }}" alt="" style="height: 60px; margin: 0 15px;">
                {% endif %}
                {% if section.funder_logo_4 %}
                    <img src="{{ section.funder_logo_4.url }}" alt="" style="height: 60px; margin: 0 15px;">
                {% endif %}
            </div>
            {% endif %}
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- Contact details -->
<div class="contact-details" style="text-align: center; margin: 2rem 0;">
    <p><strong>Address / Cyfeiriad:</strong> Unit 2 Bank Lane, Machynlleth, Powys, SY20 8JB</p>
    <p><strong>Email / E-bost:</strong> <a href="mailto:splojmach@gmail.com">splojmach@gmail.com</a></p>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.carousel-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const id = btn.dataset.carousel;
            const direction = btn.classList.contains('prev') ? -1 : 1;
            moveCarousel(id, direction);
        });
    });
});

function moveCarousel(id, direction) {
    const carousel = document.getElementById('carousel-' + id);
    const track = carousel.querySelector('.carousel-track');
    const slides = carousel.querySelectorAll('.carousel-slide');
    if (slides.length > 0) {
        const slideWidth = slides[0].clientWidth;
        track.scrollBy({
            left: direction * slideWidth,
            behavior: 'smooth'
        });
    }
}
</script>
{% endblock %}
